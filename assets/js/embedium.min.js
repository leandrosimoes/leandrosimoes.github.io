!function(e){var t={};function n(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(r,s,function(t){return e[t]}.bind(null,s));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(1)),o=r(n(2)),a=r(n(3)),l=s(n(4));class d{constructor(e){this.version="1.0.0",this._environment="develop",this._user=new i.default(e),document.addEventListener("click",e=>{let t=e.target;if(t&&t.classList&&t.className.indexOf("embedium-posts-post")>=0){let e=10,n="";for(;e>0&&!n;)(n=t.dataset.embediumUrl||"")||(t=t.parentElement||new HTMLElement);n&&window.open(n,"_blank")}})}getUserContent(){return new Promise((e,t)=>{l.fetchUserContent(this._user,this._environment).then(t=>{console.log(l.xml2json(t,"")),e(l.xml2json(t,""))})})}embedTo(e){e&&this.getUserFeed().then(t=>{let n=t,r='                \n                <div class="embedium-posts-post-data-photo">\n                    <img class="embedium-posts-post-data-photo-image" src="{{cover-url}}" style="width:{{width}};" alt="Medium post photo">                            \n                </div>\n            ',s=`\n                <div class="embedium-container">\n                    <div class="embedium-posts">\n                        ${n.Posts.map(e=>`\n                    <div class="embedium-posts-post" data-embedium-url="${e.Link}">\n                        <div class="embedium-posts-post-user">\n                            <div class="embedium-posts-post-user-photo">\n                                <img class="embedium-posts-post-user-photo-image" src="${n.User.Photo}" alt="Medium user photo">\n                            </div>\n                            <div class="embedium-posts-post-user-data">\n                                <div class="embedium-posts-post-user-data-name">\n                                    <a target="_blank" href="${n.User.Profile}">${n.User.Name}</a>\n                                </div>\n                                <div class="embedium-posts-post-user-data-date">${l.getPostFormatedDate(e.PubDate)}</div>\n                            </div>\n                        </div>\n                        <div class="embedium-posts-post-data">\n                            ${e.HasCover?r.replace("{{cover-url}}",e.Cover).replace("{{width}}",e.Width):""}\n                            <div class="embedium-posts-post-data-title">\n                                ${e.Title}\n                            </div>\n                            <div class="embedium-posts-post-data-abreviation">\n                                ${e.Description}\n                            </div>\n                            <div class="embedium-posts-post-data-read-more">\n                                <a target="_blank" href="${e.Link}">Read more...</a>\n                            </div>\n                        </div>\n                    </div>\n                `).join("")}\n                    </div>\n                </div>\n            `;e.innerHTML=s})}getUserFeed(){return new Promise((e,t)=>{this.getUserContent().then(t=>{let n=t.rss.channel.item.map(e=>{let t=e.category;return t&&!Array.isArray(t)&&(t=[t["#cdata"]]),new a.default(new Date(e.pubDate),e.title["#cdata"].toString(),(t||[]).map(e=>e["#cdata"]),e["dc:creator"]["#cdata"],e.link.toString(),e["content:encoded"]["#cdata"])});this._user=new i.default(this._user.User,this._user.Name||t.rss.channel.title["#cdata"].replace("Stories by","").replace("on Medium","").trim(),t.rss.channel.image.url),n=n.filter(e=>e.Categories.filter(e=>"embedium"===e).length>0);let r=new o.default(t.rss.channel.title["#cdata"],this._user,n,new Date(t.rss.channel.lastBuildDate));e(r)})})}}t.default=d,(e=>{e.Embedium=d})(window)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t="",n=""){this._user=(e||"").replace(/\@/g,""),this._name=t||"",this._photo=n||""}get User(){return this._user}get Name(){return this._name}get Photo(){return this._photo}get Profile(){return`https://medium.com/@${this._user}`}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t,n,r){this._user=t,this._title=e||`Stories by ${this._user.Name} on Medium`,this._posts=n,this._lastBuildDate=r}get User(){return this._user}get Title(){return this._title}get Posts(){return this._posts}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t,n,r,s,i){this._pubDate=e,this._title=t,this._categories=n,this._creator=r,this._link=s,this._content=i}get PubDate(){return this._pubDate}get Title(){return this._title}get Categories(){return this._categories}get Creator(){return this._creator}get Link(){return this._link}get Content(){return this._content}get Cover(){let e=document.createElement("div");e.innerHTML=this._content;let t=e.getElementsByTagName("img")||[];return t.length<=0?"":t[0].src}get HasCover(){let e=document.createElement("div");e.innerHTML=this._content;let t=e.getElementsByTagName("img")||[];return t.length>0&&t[0].src.indexOf("max")>0}get Description(){let e=document.createElement("div");e.innerHTML=this._content;let t=e.getElementsByTagName("p")||[];if(t.length<=0)return"No description";let n=t[0].innerText||"";return n.length>140&&(n=n.substring(0,137)+"..."),n}get Width(){let e=this.Cover;if(!e)return"0";let t=new RegExp(/max\/\d{0,20}\//g),n=e.match(t);return t=new RegExp(/\d/g),!n||n.length<=0?"0":(n[0].match(t)||[""]).join("")+"px"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r={0:"Jan",1:"Feb",2:"Mar",3:"Apr",4:"May",5:"Jun",6:"Jul",7:"Aug",8:"Sep",9:"Oct",10:"Nov",11:"Dec"};t.getPostFormatedDate=function(e){return`${r[e.getMonth()]} ${e.getDay()}, ${e.getFullYear()}`},t.xml2json=function(e,t){var n={toObj:function(e){var t={};if(1==e.nodeType){if(e.attributes.length)for(var r=0;r<e.attributes.length;r++)t["@"+e.attributes[r].nodeName]=(e.attributes[r].nodeValue||"").toString();if(e.firstChild){for(var s=0,i=0,o=!1,a=e.firstChild;a;a=a.nextSibling)1==a.nodeType?o=!0:3==a.nodeType&&a.nodeValue.match(/[^ \f\n\r\t\v]/)?s++:4==a.nodeType&&i++;if(o)if(s<2&&i<2)for(n.removeWhite(e),a=e.firstChild;a;a=a.nextSibling)3==a.nodeType?t["#text"]=n.escape(a.nodeValue):4==a.nodeType?t["#cdata"]=n.escape(a.nodeValue):t[a.nodeName]?t[a.nodeName]instanceof Array?t[a.nodeName][t[a.nodeName].length]=n.toObj(a):t[a.nodeName]=[t[a.nodeName],n.toObj(a)]:t[a.nodeName]=n.toObj(a);else e.attributes.length?t["#text"]=n.escape(n.innerXml(e)):t=n.escape(n.innerXml(e));else if(s)e.attributes.length?t["#text"]=n.escape(n.innerXml(e)):t=n.escape(n.innerXml(e));else if(i)if(i>1)t=n.escape(n.innerXml(e));else for(a=e.firstChild;a;a=a.nextSibling)t["#cdata"]=n.escape(a.nodeValue)}e.attributes.length||e.firstChild||(t=null)}else 9==e.nodeType?t=n.toObj(e.documentElement):alert("unhandled node type: "+e.nodeType);return t},toJson:function(e,t,r){var s=t?'"'+t+'"':"";if(e instanceof Array){for(var i=0,o=e.length;i<o;i++)e[i]=n.toJson(e[i],"",r+"\t");s+=(t?":[":"[")+(e.length>1?"\n"+r+"\t"+e.join(",\n"+r+"\t")+"\n"+r:e.join(""))+"]"}else if(null==e)s+=(t&&":")+"null";else if("object"==typeof e){var a=[];for(var l in e)a[a.length]=n.toJson(e[l],l,r+"\t");s+=(t?":{":"{")+(a.length>1?"\n"+r+"\t"+a.join(",\n"+r+"\t")+"\n"+r:a.join(""))+"}"}else s+="string"==typeof e?(t&&":")+'"'+e.toString()+'"':(t&&":")+e.toString();return s},innerXml:function(e){let t="";if("innerHTML"in e)t=e.innerHTML;else{let n=function(e){let t="";if(1==e.nodeType){t+="<"+e.nodeName;for(let n=0;n<e.attributes.length;n++)t+=" "+e.attributes[n].nodeName+'="'+(e.attributes[n].nodeValue||"").toString()+'"';if(e.firstChild){t+=">";for(let r=e.firstChild;r;r=r.nextSibling)t+=n(r);t+="</"+e.nodeName+">"}else t+="/>"}else 3==e.nodeType?t+=e.nodeValue:4==e.nodeType&&(t+="<![CDATA["+e.nodeValue+"]]>");return t};for(let r=e.firstChild;r;r=r.nextSibling||new Node)t+=n(r)}return t},escape:function(e){return e.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(e){e.normalize();for(var t=e.firstChild;t;)if(3==t.nodeType)if(t.nodeValue.match(/[^ \f\n\r\t\v]/))t=t.nextSibling;else{var r=t.nextSibling;e.removeChild(t),t=r}else 1==t.nodeType?(n.removeWhite(t),t=t.nextSibling):t=t.nextSibling;return e}};9==e.nodeType&&(e=e.documentElement);var r=n.toJson(n.toObj(n.removeWhite(e)),e.nodeName,"\t");return JSON.parse("{\n"+t+(t?r.replace(/\t/g,t):r.replace(/\t|\n/g,""))+"\n}")},t.fetchUserContent=function(e,t=""){return new Promise((n,r)=>{let s=new XMLHttpRequest;s.open("GET",`${"develop"===t?"https://cors-anywhere.herokuapp.com/":""}https://medium.com/feed/@${e.User.replace(/\@/g,"")}`),s.setRequestHeader("Access-Control-Allow-Origin","*"),s.setRequestHeader("Access-Control-Allow-Methods","GET"),s.addEventListener("load",e=>{n(e)}),s.onreadystatechange=(()=>{if(4==s.readyState)if(200==s.status)if(s.responseXML)n(s.responseXML);else try{var e=new DOMParser;n(e.parseFromString(s.response,"text/xml"))}catch(e){r(e)}else r("User content could not be loaded - please check if the url exists and if it is loaded from the same domain as the website!")}),s.send()})}}]);